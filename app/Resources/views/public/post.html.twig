{% extends '::layout/base.html.twig' %}

{% block title %}{{ post.title }}{% endblock %}

{% block body %}

    <div class="container" id="post">
        <div class="row">

            <article class="col s12 l8 post-content">


                <header class="post-header">
                    <h1>{{ post.title }}</h1>
                    <img src="{{ asset(post.image.AssetPath)}}" class='responsive-img' alt="{{ post.image.name }}" >
                </header>

                <p class="post-text">
                    {{ post.content|raw|nl2br }}
                </p>

                <p class="pull-right">Créé le {{ post.created | date('d/m/Y') }} par {{ post.idUser.username }}</p>
                <p>Catégorie : <a href="{{ path('post_category',{"slug" : post.category.slug}) }}">{{ post.category.name }} </a></p>

                {% if post.tags|length > 0 %}
                    <p>Tags : {% for tag in post.tags %}{{ tag.name}}{% if not loop.last %}, {% endif %} {% endfor %}</p>
                {% endif %}

                <div class="clearfix"></div>

                {{ form_start(form) }}

                <h4>Ajouter un commentaire</h4>

                <form class="col s12">
                    <div class="row">
                        <div class="input-field col s6">
                            {{ form_label(form.username) }}
                            {{ form_errors(form.username) }}
                            {{ form_widget(form.username) }}
                        </div>
                        <div class="input-field col s6">
                            {{ form_label(form.email) }}
                            {{ form_errors(form.email) }}
                            {{ form_widget(form.email) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            {{ form_label(form.content) }}
                            {{ form_errors(form.content) }}
                            {{ form_widget(form.content) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-field col s12">
                            <button type="submit" class="btn btn-round btn-success">Valider</button>
                        </div>
                    </div>
                    {{ form_widget(form) }}
                </form>


                {{ form_end(form) }}


                <h5>Liste des commentaires</h5>

                {% if comments|length > 0 %}

                    {% for comment in comments %}
                        <p>Par {{ comment.username}}  le {{ comment.created | date('d/m/Y à h:m') }}</p>
                        <p>{{ comment.content | raw | nl2br}}</p>

                        {% if not loop.last %}<hr> {% endif %}
                    {% endfor %}

                {% else %}

                    <p>Aucun commentaire</p>

                {% endif %}




            </article>

            <div class="col s12 l3 offset-l1 sidebar">
                {{ render(controller('AppBundle:Default:sidebar')) }}
            </div>

        </div>
    </div>


{% endblock %}

